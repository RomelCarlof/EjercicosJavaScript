from flask import Flask, render_template_string, request
import random

app = Flask(__name__)

# --- CONFIGURACI√ìN ---
capitulos = {
    1: "Introducci√≥n a los algoritmos",
    2: "Algoritmos de ordenaci√≥n",
    3: "T√©cnicas de dise√±o de algoritmos",
    4: "Problemas tipo",
    5: "Algoritmos de b√∫squeda",
    6: "Descenso del gradiente",
    7: "M√©todos heur√≠sticos y metaheur√≠sticos",
    8: "Algoritmos evolutivos y gen√©ticos"
}

# --- GENERADOR DE PREGUNTAS ---
def generar_preguntas():
    preguntas = []
    id_counter = 0
    for cap in range(1, 9):
        for i in range(1, 6):  # 5 preguntas por cap√≠tulo = 40 total
            tema = capitulos[cap]
            opciones = [
                f"A) Opci√≥n incorrecta sobre {tema.lower()}",
                f"B) Otra opci√≥n irrelevante",
                f"C) Una posible confusi√≥n com√∫n",
                f"D) Respuesta correcta relacionada con {tema.lower()}"
            ]
            correcta = "D"
            random.shuffle(opciones)
            preguntas.append({
                'id': id_counter,
                'texto': f"(Cap. {cap}) ¬øCu√°l es la opci√≥n correcta sobre: {tema} ({i})?",
                'opciones': opciones,
                'correcta': correcta
            })
            id_counter += 1
    random.shuffle(preguntas)
    return preguntas[:40]

# --- PLANTILLA HTML ---
template = """
<!DOCTYPE html>
<html lang='es'>
<head>
    <meta charset='UTF-8'>
    <title>Simulacro de Examen</title>
    <style>
        body { font-family: Arial; margin: 40px; }
        .pregunta { background: #f4f4f4; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        button { background-color: #074f0f; color: white; padding: 10px 20px; border: none; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üß† Simulacro de Examen - Algoritmos</h1>
    <form method="POST">
        {% for p in preguntas %}
        <div class="pregunta">
            <p><strong>{{ loop.index }}. {{ p.texto }}</strong></p>
            {% for opcion in p.opciones %}
                <label><input type="radio" name="pregunta{{ p.id }}" value="{{ opcion[0] }}"> {{ opcion }}</label><br>
            {% endfor %}
        </div>
        {% endfor %}
        <button type="submit">Enviar respuestas</button>
    </form>

    {% if resultado is defined %}
    <hr>
    <h2>‚úÖ Resultado: {{ resultado }} / {{ total }} correctas</h2>
    <p>üìä Puntaje: {{ porcentaje }}%</p>
    {% endif %}
</body>
</html>
"""

# --- RUTA PRINCIPAL ---
@app.route('/', methods=['GET', 'POST'])
def index():
    global preguntas_global
    if request.method == 'POST':
        respuestas = request.form
        correctas = 0
        total = len(preguntas_global)
        for
